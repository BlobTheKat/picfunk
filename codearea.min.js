{const e=CSS.supports("-webkit-backdrop-filter","none"),t=new Map,i=new CSSStyleSheet,l=new CSSStyleSheet;l.insertRule("code-area{user-select:none !important;-webkit-user-select:none !important;position:relative !important;tab-size:2;box-sizing:border-box !important;-webkit-tap-highlight-color:#0000 !important;text-size-adjust: none !important;-webkit-text-size-adjust: none !important;touch-action: pan-y !important;display:grid !important;white-space:pre-wrap !important;font-family:monospace;overflow-wrap:break-word;overflow:auto !important;line-height:1.2;scrollbar-width:0;--max-line-width:100%;grid-template-columns:minmax(auto,var(--max-line-width));--min-gutter:0}",0),l.insertRule("code-area::-webkit-scrollbar{display: none}",1),document.adoptedStyleSheets.push(l),i.insertRule("textarea{z-index:1;padding:0;padding-left:max(1ch,var(--min-gutter) * 1ch);margin:0;inset:0;border:none;outline:none;background:none;font:inherit;color:#0000;resize:none;caret-color:#999;white-space:pre-wrap;tab-size:inherit;box-sizing:border-box;-webkit-tap-highlight-color:#0000;text-size-adjust: none;-webkit-text-size-adjust: none;touch-action:pan-y;overflow-wrap:inherit;overflow:clip;grid-area:1/1}",0),i.insertRule("textarea::selection{background: Highlight}",1),i.insertRule("div{min-height:1lh}",2),i.insertRule("label{box-sizing:border-box;position:absolute;left:0;width:calc(var(--g) + 0.25lh);display:block;white-space:pre;color:#808080;padding-right:0.25lh;clip-path:polygon(0 0, calc(100% - 0.25lh) 0, 100% 50%, calc(100% - 0.25lh) 100%, 0 100%);z-index:2;cursor:pointer;counter-increment:l}",3),i.insertRule("label::before{content:counter(l);display:inline-block;width:var(--g);text-align:right}",4),i.insertRule("main{grid-area:1/1;--g:max(1ch,var(--min-gutter) * 1ch);padding-left:var(--g)}",5),i.insertRule("label[data-message]:hover::after{content:attr(data-message);display:inline-block;padding-left:0.5lh;white-space:pre-wrap;vertical-align:top;width:calc(100% - var(--g) - 0.25lh)}",6),i.insertRule("label[data-message]:hover{width:100%;z-index:3;padding:var(--hover-padding)}",7);const s=document.createElement("p");globalThis.CodeAreaStyle=e=>{if("object"==typeof e&&(Object.assign(s.style,e),e=s.getAttribute("style"),s.style=""),"."==e[0])return e;let l=t.get(e);return void 0===l&&(t.set(e,l=Symbol.for("c"+t.size)),i.insertRule(`.${l.description}{${e}}`,t.size+2)),l},customElements.define("code-area",globalThis.CodeAreaElement=class t extends HTMLElement{static observedAttributes=["value","disabled"];#e=[];#t="";#i=null;#l=1;get firstLine(){return this.#l}set firstLine(e){this.#l=Math.floor(+e||0),this.#s.style.counterReset="l "+(this.#l-1)}get visibleLineCount(){return.5*this.#s.childNodes.length}get defaultLineStyle(){return this.#i}set defaultLineStyle(e){const t=this.#t;if(this.#t=e=(this.#i="symbol"==typeof e?e:null)?e.description:"",e==t)return;const i=this.#s.childNodes;for(let l=i.length-2;l>=0;l-=2){const s=i[l].classList;t?e?s.replace(t,e):s.remove(t):e&&s.add(e)}}setLineStyle(e,t=null,i=null){t="symbol"==typeof t?t.description:this.#t;const l=this.#s.childNodes[2*Math.floor(e-this.#l)];return!!l&&(l.className=t,"string"==typeof i?l.dataset.message=i:delete l.dataset.message,!0)}resetAllLineStyles(){const e=this.#s.childNodes;for(let t=e.length-2;t>=0;t-=2){const i=e[t];i.className=this.#t,"string"==typeof message?i.dataset.message=message:delete i.dataset.message}}getLineStyle(e=0){const t=this.#s.childNodes[2*Math.floor(e-this.#l)]?.classList;return t&&t.length?Symbol.for(t[0]):null}getLineMessage(e=1){const t=this.#s.childNodes[2*Math.floor(e-this.#l)];return t?t.dataset.message??null:null}onlineclick=null;get basePattern(){return this.#e}set basePattern(e){this.#e=Array.isArray(e)?e:[],this.rehighlight()}#n=this.attachShadow({mode:"closed"});#s=document.createElement("main");#a=document.createElement("textarea");#o=0;#r=0;#h=0;#c=0;#d=0;static#u=document.addEventListener("selectionchange",(()=>{const e=document.activeElement;e instanceof t&&e&&(e.#h=e.#a.selectionStart,e.#c=e.#a.value.length-e.#a.selectionEnd)}));compile=()=>{this.#o||(this.#o=requestAnimationFrame((()=>this.#g())))};cancelCompile(){this.#o<0||(cancelAnimationFrame(this.#o),this.#o=0)}oncompile=null;#g(){this.#o=0,this.oncompile?.call(this,this.#a.value)}get disabled(){return this.#a.disabled}set disabled(e){this.#a.disabled=e}get value(){return this.#a.value}set value(e){this.#a.value=e,this.rehighlight(),this.compile()}get selectionStart(){return this.#a.selectionStart}get selectionEnd(){return this.#a.selectionEnd}set selectionStart(e){this.#a.selectionStart=e}set selectionEnd(e){this.#a.selectionEnd=e}constructor(){super(),this.#n.adoptedStyleSheets.push(i),this.#n.appendChild(this.#s),this.#n.append(this.#a),this.#a.spellcheck=!1,this.#a.onchange=this.compile,this.#a.onkeydown=e=>{if(13===e.keyCode&&e.shiftKey)return this.#o||this.#g(),!1;if(9===e.keyCode){const t=this.#a.selectionStart,i=this.#a.selectionEnd,l=this.#a.value;return t===i?(this.#a.value=l.slice(0,t)+"\t"+l.slice(t),this.#a.selectionStart=this.#a.selectionEnd=t+1):(e.shiftKey?this.#a.value=l.slice(0,t)+l.slice(t,i).replace(/\n\t/g,"\n")+l.slice(i):this.#a.value=l.slice(0,t)+l.slice(t,i).replace(/\n/g,"\n\t")+l.slice(i),this.#a.selectionStart=t,this.#a.selectionEnd=i+this.#a.value.length-l.length),this.#a.oninput(),!1}},this.#a.oninput=t=>{if(this.#r){if("number"!=typeof t)return;this.#r=0}const i=this.#a.value;let l=Math.min(this.#h,this.#h=this.#a.selectionStart),s=0,n=1,a=1,o=0;const r=this.#s.childNodes,h=r.length-1;let c,d=r[1],u=null,g=0,p=null;const f=()=>{m.length?u!=(u=m[m.length-1])&&(g=u.length-1,p=1&u.length?u[g]:null):m.push(u)};let m=null;if(h<0){const e=d=document.createElement("div");e.setAttribute("inert","");const t=document.createElement("label");this.#t&&t.classList.add(this.#t),e.append(""),e.stack=m=[this.#e],l=e.l=0,c=e.childNodes,this.#s.append(t,e)}else for(;n<=h;n+=2){d=r[n];let e=d.l+(n==h);if((s+=e)<=l)continue;s-=e,c=d.childNodes;let t=c.length-1;if(t&&s+c[1].l>=l&&n>1)do{e=(d=r[n-=2]).l,s-=e,c=d.childNodes,t=c.length-1}while(t<1&&n>1);m=d.stack.slice();let i=null,o=0;if(a=1,t)for(;;){const e=c[a],h=e.l;if(a==t||s+h>l)break;if(s+=o=h,i?.f){let e=i.textContent;if(a==t){let t,i=n;do{t=r[i+=2].childNodes,e+="\n",e+=t[0].textContent}while(t.length<=1)}i.f(m,e)}i=e,a++}l=s,a>1&&(l-=o,a--);break}f(),o=Math.min(this.#c,this.#c=i.length-this.#a.selectionEnd),s=o,o=this.#d-s-l,s=(this.#d=i.length)-s-l;let b=c[a];const x=m.slice(),y=(e,t)=>{let i=null;"function"==typeof t&&(t=(i=t)(m,e),f());let l,s=e,o=e.indexOf("\n"),r=e.length;for(o>=0&&(s=e.slice(0,o),e=e.slice(o+1)),t?(l=document.createElement("span"),l.append(s),"symbol"==typeof t?l.classList.add(t.description):"string"==typeof t?l.style=t:"object"==typeof t&&Object.assign(l.style,t)):l=s?document.createTextNode(s):document.createComment(""),l.l=r,l.f=i,d.l+=r,d.insertBefore(l,b),a++;o>=0;){let i,h;if(o=e.indexOf("\n"),o>=0?(s=e.slice(0,o),e=e.slice(o+1)):(s=e,r=-1),t?(l=document.createElement("span"),l.append(s),"symbol"==typeof t?l.classList.add(t.description):"string"==typeof t?l.style=t:"object"==typeof t&&Object.assign(l.style,t)):l=s?document.createTextNode(s):document.createComment(""),S.length)({0:h,1:i}=S.splice(0,2)),i.firstChild.replaceWith(l),i.stack=m.slice();else{i=document.createElement("div"),i.setAttribute("inert",""),h=document.createElement("label"),this.#t&&h.classList.add(this.#t),i.append(l);let e=0;for(this.#s.insertBefore(i,d.nextSibling),this.#s.insertBefore(h,i);c.length>a;){const t=c[a];i.append(t),e+=t.l,d.l-=t.l}i.stack=m.slice(),i.l=e}c=(d=i).childNodes,n+=2,b=c[a=1]}},S=[],v=()=>{for(;o>0;){let e=null;if(b)d.l-=b.l;else{if(!S.length)break;if(e=S[S.length-1],b=e.childNodes[1],!b)break;e.l-=b.l}o-=b.l,b.remove();let t=b.textContent,i=b.f;if(e?1==e.childNodes.length:a==c.length){let e,l=n+S.length;for(;(e=r[l+2])&&(S.push(r[l+1],e),l+=2,i&&(t+="\n",t+=e.childNodes[0].textContent),!(e.childNodes.length>1)););b=void 0}else b=e?void 0:c[a];i&&i(x,t)}};v(),o-=s;let w=0;e:for(;l+w<i.length;){for(let e=0;e<g;e+=2){const t=u[e];if(t.lastIndex=l+w,!t.test(i))continue;const s=t.lastIndex-l;if(!s&&!t.flags.includes("y")){console.error("Regex %s doesn't have the y flag",t);continue}if(o+=s,v(),w&&y(i.slice(l,l+w),p),y(i.slice(l+w,l+=s),u[e+1]),w=0,o)continue e;const n=m.length;if(n!=x.length)continue e;for(let e=n-1;e>=0;e--)if(m[e]!=x[e])continue e;break e}w++}if(w&&(o+=w,v(),y(i.slice(l),p)),S.length){const e=S[S.length-1].childNodes;for(const e of S)e.remove();for(;e.length>1;){const t=e[1];d.insertBefore(e[1],b),d.l+=t.l}}const k=Math.floor(Math.log10(Math.max(-this.#l,.5*r.length+this.#l-1)))+1.5;this.#s.style.setProperty("--g",this.#a.style.paddingLeft=`max(var(--min-gutter) * 1ch,${k}ch)`),e&&(this.#a.style.display="none",this.#a.offsetWidth,this.#a.style.display="")},this.#s.onclick=e=>{const t=e.composedPath()[0];if(!(t instanceof HTMLLabelElement))return;const i=this.#s.childNodes,l=i.length;for(let e=0;e<l;e++)if(i[2*e]==t){this.onlineclick?.(e+this.#l,this);break}return!1}}attributeChangedCallback(e,t,i){"disabled"==e?this.disabled=null!=i:"value"==e&&(this.value=i)}rehighlight(){if(this.#r)return;this.#h=this.#c=this.#d=0;const e=this.#s.childNodes;let t=e.length;for(;t;)e[--t].remove();this.#r=requestAnimationFrame(this.#a.oninput)}})}